var editor=ace.edit("editor",{mode:"ace/mode/javascript",selectionStyle:"text"});editor.setTheme("ace/theme/github"),editor.session.setMode("ace/mode/javascript");var EditSession=ace.require("ace/edit_session").EditSession,Range=ace.require("ace/range").Range;const questionTemplate='<div class="question-expand" onclick="expandQ(this)">\n{{status}}\n<div class="question-content">\n  <p class="question-content-text">\n    {{question}}\n  </p>\n  <span class="circle"></span>\n  <textarea></textarea>\n  <button class="btn-success btn" >Send</button>\n</div>\n</div>\n';editor.setReadOnly(!0);var code=editor.session.getDocument(),insertFromNetwork=(e,n)=>{1==n.length?insertChangeText():changeLines()};function createElementFromHTML(e){var n=document.createElement("div");return n.innerHTML=e.trim(),n.firstChild}const QuestionManager=function(){var e=document.querySelector(".right"),n=[];return{addQuestion:t=>{var o=createElementFromHTML(Mustache.render(questionTemplate,t));n.push(o);var s=n.length-1,a=o.querySelector(".question-content"),i=o.querySelector("textarea");o.querySelector("button").addEventListener("click",function(){console.log(i.value),sendAnswer(s,i.value),o.classList.toggle("question-active"),r.nodeValue="done",c.classList.add("circle-done")});var r=o.childNodes[0];r.nodeValue="Q: "+t.question.slice(0,30);var c=o.querySelector(".circle");a.querySelector("textarea").addEventListener("input",function(e){r.nodeValue="editing",c.classList.add("circle-editing")}),a.addEventListener("click",function(e){e.stopPropagation(),console.log("child clicked")}),e.appendChild(o)},removeQuestion:e=>{n[e].style.margin="0px",n[e].style.maxHeight="0",n[e].style.padding="0",console.log(n[e].style.transform);var t=n[e];setTimeout(()=>{t.remove()},500),n.splice(e,1)}}}();function handlerFunctions(){return{i:e=>{let n=e.split("/!");var t={row:parseInt(n[0],10),column:parseInt(n[1],10)};if(console.log(n),code.insert(t,n[2]),n.length>3){var o=n.slice(3);code.insertLines(t.row+1,o)}},l:e=>{let n={row:parseInt(e,10),column:0};code.insertNewLine(n)},r:e=>{let n=e.split("/!");var t={row:parseInt(n[0],10),column:parseInt(n[1],10)},o={row:parseInt(n[2],10),column:parseInt(n[3],10)},s=new Range(t.row,t.column,o.row,o.column);code.remove(s)},q:e=>{let n=e.split("/!");console.log(n[0]);var t={status:"unfinished",question:n[0]};QuestionManager.addQuestion(t)},p:e=>{let n=e.split("/!")[0];messageArray[0];QuestionManager.removeQuestion[n]},close:function(e){alert("the teacher has left the classroom")}}}const handlers=handlerFunctions();code.on("change",e=>{console.log(e)});var ws=new WebSocket("ws://"+window.location.hostname+":"+window.location.port),sendAnswer=function(e,n){ws.send("a"+e+"/!"+n+"/!"+name)};ws.onopen=function(){console.log(ClassCode),ws.send("student"),ws.send(ClassCode),ws.send("initiliazation sequence #3- apply all previous changes")},ws.onerror=function(e){console.log(e)},ws.onmessage=function(e){let n=e.data;console.log(n),handlers[n.charAt(0)](n.slice(1))};